<!DOCTYPE HTML>
<html lang="zh-CN">
<head>
    <title></title>
    <meta name="Keywords" content="双周年，好设计，红包，免费，设计师，原创，手工，个性，定制，减价，折扣，江南布衣，独立，文艺，小清新">
    <meta name="Description" content="921现金大礼包任意领，更有ipad mini等你拿">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />
    <meta content="telephone=no" name="format-detection" />
    <meta name="apple-touch-fullscreen" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <script>
        (function(){
            function RemInit(){
                var dpr, rem, scale;
                var docEl = window.document.documentElement;
                var bodyEl = window.document.body;
                var metaEl = window.document.querySelector('meta[name="viewport"]');
                var psdWidth = 640/100;
                var isAndroid = navigator.userAgent.match(/Android[\S\s]+AppleWebkit\/(\d{3})/i);
                dpr = 1;
                if(navigator.userAgent.indexOf('xiangqu')>-1 && navigator.userAgent.indexOf('Android')>-1){
                    var setWidthTime = setInterval(function(){
                        if(docEl.clientWidth>0){
                            clearInterval(setWidthTime);
                        }
                    },100)
                }
                rem = docEl.clientWidth * dpr / psdWidth;
                docEl.style.fontSize = rem +'px'
                docEl.setAttribute('data-dpr', dpr);
                scale = 1 / dpr;
                metaEl.setAttribute('content', 'width=' + dpr * docEl.clientWidth + ',initial-scale=' + scale + ',maximum-scale=' + scale + ', minimum-scale=' + scale + ',user-scalable=no');
                window.dpr = dpr;
                window.rem = rem;
                window.addEventListener('resize',function(){
                    rem = docEl.clientWidth * dpr / psdWidth;
                    docEl.style.fontSize = rem +'px'
                })
            }
            RemInit();
        })()
    </script>
    <style>
        canvas{
            /*width: 6rem;
            height: 6rem;*/
            border: 1px solid red;
            /*display:none;*/
        }
        #myImg{
            margin: 1rem;
            width: 3rem;
            height: 3rem;
            border: 1px solid red;
        }
    </style>
</head>
<body>
    <canvas id="myCanvas" width="300" height="300">
    </canvas>
    <div id="myImg">

    </div>
</body>
<script type="text/javascript">
    (function(){
        var myNameObj = [{sign:'aaa',X:10,Y:20,font:'28px Arial'},{sign:'bbb',X:30,Y:80,font:'72px Arial'},{sign:'ccc',X:50,Y:130,font:'72px Arial'}],
                /*myImgObj = ["http://xqproduct.xiangqu.com/FiKRJXeOgak6VXkXGn8kmk4vdA46?imageView2/2/w/200/q/90/format/jpg/200x200/"],*/
                myImgObj = ["52104b392e07d193.jpg!200x200.jpg"],
                Pisces =[{
                    details:['$**$去医院看$失忆症$','医生问他这病多久了','$**$想了想$说$什么病?'],
                    /*details:['aaaasssaaaaaa','ssssassasss','aasssssaasasasa'],*/
                }];
        var printTheName ={
            init:function(){
                var self = this,
                        conObj = self.printAA(Pisces,"西瓜");
                console.log(conObj);
                self.printBB(myImgObj,conObj);
                self.convertCanvasToImage("myCanvas","myImg");
            },
            printAA:function(statementObj,nameObj){
                var self = this,
                        obj = statementObj,
                        myNameObj = [{}],
                        conObj1 = [],
                        conObj2 = [],
                        conObj3 = {
                            sign:'',
                            X:0,
                            Y:0,
                            font:''
                        };
                for(var i in obj[0].details){
                    obj[0].details[i] = obj[0].details[i].replace(/\*\*/g,nameObj);
                    myNameObj[i] = obj[0].details[i].split("$");
                }
                for(var i=0;i<myNameObj.length;i++){
                    for(var j=0;j<myNameObj[i].length;j++){
                        if(j%2){
                            conObj3.sign = myNameObj[i][j];
                            conObj3.font = '24px Arial';
                            conObj3.X = 40*j;
                            conObj3.Y = 20*i+30;
                            conObj2.push(conObj3);
                            conObj3 = {
                                sign:'',
                                X:0,
                                Y:0,
                                font:''
                            };
                        }else{
                            conObj3.sign = myNameObj[i][j];
                            conObj2.push(conObj3);
                            conObj3.font = '16px Arial';
                            conObj3.X = 40*j;
                            conObj3.Y = 20*i+30;
                            conObj3 = {
                                sign:'',
                                X:0,
                                Y:0,
                                font:''
                            };
                        }
                    }
                    conObj1.push(conObj2);
                    conObj2 = [];
                }
                /*console.log(myNameObj);
                console.log(conObj1);*/
                return conObj1;
            },
            printBB:function(imgObj,nameObj){
                var self = this,
                    canvas = document.getElementById("myCanvas");
                self.myRem = window.rem;
                if(canvas.getContext){
                    var ctx = canvas.getContext("2d");
                    var myImg = new Image();
                    myImg.src = imgObj[0];
                    myImg.onload = function(){
                        ctx.beginPath();
                        //设置线条颜色为蓝色
                        ctx.strokeStyle = "blue";
                        //以canvas中的坐标点(10,10)作为绘制起始点，绘制一个宽度为80px、高度为50px的矩形
                        ctx.rect(10, 10, 80, 50);
                        //按照指定的路径绘制直线
                        ctx.stroke();
                        //关闭绘制路径
                        ctx.closePath();
                       /* ctx.drawImage(myImg,10,10,200,200);*/
                       /* for(var i=0;i<nameObj.length;i++){
                            for(var j=0;j<nameObj[i].length;j++){
                                ctx.font = nameObj[i][j].font;
                                ctx.fillText(nameObj[i][j].sign,nameObj[i][j].X,nameObj[i][j].Y);
                            }
                        }*/
                    };
                }
            },
            convertCanvasToImage:function(canvasObj,imgObj){
                var image = new Image();
                image.src = document.getElementById(canvasObj).toDataURL();
                console.log(document.getElementById(canvasObj).toDataURL());
                console.log(document.getElementById(canvasObj));
                /*obj.innerHTML = image;*/
                document.getElementById(imgObj).appendChild(image);
            },
        }
        printTheName.init();
    })();

</script>
</html>



